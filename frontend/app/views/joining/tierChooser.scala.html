@(eventOpt: Option[model.Eventbrite.EBEvent])(implicit token: play.filters.csrf.CSRF.Token)

@import com.gu.membership.salesforce.Tier
@import model.Benefits
@import model.Eventbrite.EBEventStatus._
@import views.support.Dates._
@import helper._

@benefit(tier: com.gu.membership.salesforce.Tier.Tier) = {
    <div class="tickets-select-form__section">
        <div class="tickets-select-form__header u-cf">
            <label class="tickets-select-form__label" for="@tier.toString.toLowerCase">
                <input class="tickets-select-form__input" type="radio" value="friend" id="@tier.toString.toLowerCase" name="tier"/>
            </label>
            <div class="tickets-select-form-header__secondary u-cf">
                <div class="price-info-container">
                    <h2 class="tickets-select-form__tier-name">@tier</h2>
                </div>
                <div class="price-info-container price-info-container--last">
                    @fragments.benefits.priceInfo(Benefits.details(tier))
                </div>
                <a class="tickets-select-form__toggle mobile-only js-benefit-header" href="#">
                    <i class="i icon-sprite-arrow-grey-large tickets-select-form__toggle-icon js-toggle-icon"></i>
                </a>
            </div>
        </div>
        <div class="tickets-select-form__detail hidden-mobile">
            <p class="tickets-select-form__leadin">@Benefits.details(tier).leadin</p>
            <ul class="u-unstyled">
                @for((header, body) <- Benefits.details(tier).list) {
                <li class="benefits-title">@header</li>
                <li class="benefits-copy">@body</li>
                }
            </ul>
        </div>
    </div>
}

@main("Join membership") {

    <section class="section-two-thirds">

        @fragments.tickets.ticketsFunnel(1, StepTwo = "", StepThree = "", StepFour = "")

        <div class="l-row">

        <section class="two-thirds">

            <h1 class="section-sub-headline">Choose a membership tier</h1>

            <form action="" method="POST" id="payment-form" class="form tickets-select-form">
                @CSRF.formField

                @for(tier <- Tier.values.toSeq.sorted){
                    @if(tier != Tier.None){
                        @benefit(tier)
                    }
                }

                <input type="submit" class="action action--logged-in" value="Join today"/>

            </form>
        </section>@*

            //inline-block whitespace

        *@<section class="one-third">

            @for(event <- eventOpt) {

                <h2 class="section-sub-headline">You're buying tickets for:</h2>

                <a href="/event/@event.id">
                    <div class="item__media-wrapper">
                        <div class="item__image-container event-image-container">
                            @if(event.getStatus == SoldOut){
                                <span class="event-status event-status--sold-out">Sold Out</span>
                            }
                            <img src="@event.logoUrl" alt="Event Image">
                        </div>
                    </div>
                    <h2 class="item__title truncate">
                    @event.name.text
                    </h2>
                </a>
                <div class="item__meta">
                    <time class="item__timestamp js-item__timestamp">
                        <div class="event__location">@event.venue.name</div>
                        <div class="event__time">@event.start.pretty</div>
                    </time>
                </div>
                @for(ticket <- event.ticketClassesHead) {
                    <div class="event__tickets">

                    @if(ticket.free) {
                        <div class="event__price">
                            <span class="event__price-amount js-event-price">Free</span>
                        </div>
                    } else {
                        @for(pricing <- ticket.cost) {
                            <div class="event__price">
                                <span class="event__price-amount js-event-price">@pricing.formattedPrice</span>
                                <span class="event__price-note js-event-price-note"> per ticket</span>
                            </div>
                        }
                    }

                    </div>
                }
            }

        </section>
        </div>
    </section>



}
