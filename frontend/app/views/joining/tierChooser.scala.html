@(eventOpt: Option[model.Eventbrite.EBEvent], pageInfo: model.PageInfo)(implicit token: play.filters.csrf.CSRF.Token)

@import com.gu.membership.salesforce.Tier
@import views.support.Dates._
@import configuration.Config


@main("Join Choose Tier", pageInfo=pageInfo, containerPadding = false, isBrochure = true) {

    <section class="section-two-thirds u-cf">

        @fragments.form.sectionHeading("Choose a membership tier")

        <div class="l-row">
            <section class="two-thirds">

            @fragments.joiner.joinStepCounter(1, 3)

                <header class="section__heading u-cf">
                    <h1 class="section-headline section-headline--no-margin">Choose a membership tier</h1>
                </header>
                <div class="package-list">
                    @fragments.tier.benefits(currentTier=None, tier=Tier.Friend, showBenefitDetails=true, mode="promo", showChooseDetails=true)
                    @fragments.tier.benefits(currentTier=None, tier=Tier.Partner, showBenefitDetails=true, mode="promo", showChooseDetails=true)
                    @fragments.tier.benefits(currentTier=None, tier=Tier.Patron, showBenefitDetails=true, mode="promo", showChooseDetails=true)
                </div>

            </section>
            <section class="one-third">

            @for(event <- eventOpt) {
                <h2 class="section-sub-headline">You're buying tickets for:</h2>

                <div class="event-item events-list__item event-item--standalone">
                    <div class="event-item__media">
                        <div class="delayed-image-load" data-src="@Config.eventImageUrlPath(event.id)/{width}{pixel_ratio}.jpg" data-alt="Please upload an event image" data-class="responsive-img"></div>
                    </div>
                    <div class="event-item__meta">
                        <h2 class="event-item__title">
                            @if(event.isSoldOut){
                                <span class="event-status--sold-out">Sold Out</span>
                            }
                            @event.name.text
                        </h2>

                        <div class="event-item__time">@event.start.pretty</div>
                        <div class="event-item__location">
                            @if(event.venue.name){
                                <span class="event-item__location-name">@event.venue.name</span>
                            }
                            @for(location <- event.venue.address) {
                                <span class="event-item__location-detail">@if(event.venue.name){, } @location.city, @location.postal_code</span>
                            }
                        </div>

                        @for(desc <- event.description) {
                            <div class="event-item__description">
                                @desc.blurb
                            </div>
                        }

                        <div class="event-item__cta">
                            <div class="event-item__price">
                            @for(ticket <- event.generalReleaseTicket) {
                                @for(pricing <- ticket.cost) {
                                    <span class="event-item__price-amount">@pricing.formattedPrice</span>
                                    <span class="event-item__price-amout-discount">Partners/Patrons: @pricing.discountPrice</span>
                                }
                            }
                            </div>
                        </div>
                    </div>
                </div>
            }
            </section>
        </div>
    </section>
}
